function MapUnicodeCharacter(e){if(KeyBoardLayout==2)return bijoy_keyboard_map[e];else if(KeyBoardLayout==3)return somewherein_phonetic_keyboard_map[e];else if(KeyBoardLayout==4)return avro_phonetic_keyboard_map[e];else if(KeyBoardLayout==5)return unijoy_keyboard_map[e];return e}function ResetKarModifier(){LC_KAR=0;LC_STRING=""}function KarModification(e,t){if(LC_KAR==LCUNI||IsBanglaHalant(LCUNI)||t=="্র"||t=="্য"){var n=LC_STRING.length;LC_STRING=LC_STRING+t;RemoveNInsert(e,LC_STRING+LC_KAR,n+LC_KAR.length)}else if(t=="র্"){var n=LC_STRING.length;LC_STRING=t+LC_STRING;RemoveNInsert(e,LC_STRING+LC_KAR,n+LC_KAR.length)}else if(IsBanglaHalant(t)){LC_STRING=LC_STRING+t;Insert(e,t)}else{Insert(e,t);ResetKarModifier()}}function RefModification(e){var t=1;var n="";var r="";var i=true;var s="";e.focus();while(true){if(document.selection){sel=document.selection.createRange();if(e.value.length>=t){sel.moveStart("character",-1*t)}else{s="",t--;sel.moveStart("character",-1*t);break}s=sel.text.charAt(0)}else if(e.selectionStart||e.selectionStart==0){var o=e.selectionStart-t;var u=e.selectionEnd;var a=e.scrollTop;if(o<0){s="",t--;o=e.selectionStart-t;break}s=e.value.substring(o,o+1)}if(t!=1&&IsBanglaKar(s))break;if(t==1&&IsBanglaKar(s))n=s;else if(IsBanglaSoroborno(s)||IsBanglaDigit(s)||IsSpace(s))break;else if(IsBanglaBanjonborno(s)){if(i==true){r=s+r;i=false}else break}else if(IsBanglaHalant(s)){r=s+r;i=true}t++}var f=s+"র্"+r+n;if(document.selection){sel.text=f;sel.collapse(true);sel.select()}else if(e.selectionStart||e.selectionStart==0){e.value=e.value.substring(0,o)+f+e.value.substring(u,e.value.length);e.focus();e.selectionStart=o+f.length;e.selectionEnd=o+f.length;e.scrollTop=a}}function OAndOuKarModification(e,t,n){if(document.selection){e.focus();sel=document.selection.createRange();if(e.value.length>=1)sel.moveStart("character",-1);if(sel.text.charAt(0)=="ে")sel.text=t;else sel.text=sel.text.charAt(0)+n;sel.collapse(true);sel.select()}else if(e.selectionStart||e.selectionStart==0){var r=e.selectionStart-1;var i=e.selectionEnd;var s=e.scrollTop;var o;r=r==-1?e.value.length:r;if(e.value.substring(r,r+1)=="ে")o=t;else{r=r+1;o=n}e.value=e.value.substring(0,r)+o+e.value.substring(i,e.value.length);e.focus();e.selectionStart=r+o.length;e.selectionEnd=r+o.length;e.scrollTop=s}}function IsSomewhereinPhoneticModifierCharaceter(e){if(e=="হ"||e=="গ"||e=="ঘ"||e=="ণ"||e=="ঃ"||e=="ট"||e=="ো"||e=="ই"||e=="ি"||e=="উ"||e=="ু"||e=="র"||e=="ড়")return true;return false}function GetSomewhereinPhoneticModifiedCharaceter(e){var t=e;if(LCUNI=="ক"&&e=="হ")t="খ";else if(LCUNI=="গ"&&e=="হ")t="ঘ";else if(LCUNI=="চ"&&e=="হ")t="চ";else if(LCUNI=="জ"&&e=="হ")t="ঝ";else if(LCUNI=="ট"&&e=="হ")t="ঠ";else if(LCUNI=="ড"&&e=="হ")t="ঢ";else if(LCUNI=="ত"&&e=="হ")t="থ";else if(LCUNI=="দ"&&e=="হ")t="ধ";else if(LCUNI=="প"&&e=="হ")t="ফ";else if(LCUNI=="ব"&&e=="হ")t="ভ";else if(LCUNI=="স"&&e=="হ")t="শ";else if(LCUNI=="ড়"&&e=="হ")t="ঢ়";else if(LCUNI=="ণ"&&e=="গ")t="ঙ";else if(LCUNI=="ন"&&e=="গ")t="ং";else if(LCUNI=="ণ"&&e=="ঘ")t="ঞ";else if(LCUNI=="ণ"&&e=="ণ")t="ঁ";else if(LCUNI=="ঃ"&&e=="ঃ")t="ঃ";else if(LCUNI=="ট"&&e=="ট")t="ৎ";else if(LCUNI=="া"&&e=="ো")t="অ";else if(LCUNI=="ি"&&e=="ি")t="ী";else if(LCUNI=="ই"&&e=="ই")t="ঈ";else if(LCUNI=="ু"&&e=="ু")t="ূ";else if(LCUNI=="উ"&&e=="উ")t="ঊ";else if(LCUNI=="ও"&&e=="ই")t="ঐ";else if(LCUNI=="ো"&&e=="ি")t="ৈ";else if(LCUNI=="ও"&&e=="উ")t="ঔ";else if(LCUNI=="ো"&&e=="ু")t="ৌ";else if(LCUNI=="ৃ"&&e=="র")t="ৃ";else if(LCUNI=="ঋ"&&e=="ড়")t="ঋ";return t}function IsAvroPhoneticModifierCharaceter(e){if(e=="ঃ"||e=="ো"||e=="ি"||e=="ু"||IsBanglaSoroborno(e)||IsBanglaBanjonborno(e))return true;return false}function GetAvroPhoneticBanjonBanjonEquivalent(e,t){var n=t;if(e=="ক"&&t=="ক"||e=="ক"&&t=="খ")n="্"+t;return n}function GetAvroPhoneticModifiedCharaceter(e){var t=e;if(e!="হ"&&Avro_Cha_Flag==true)Avro_Cha_Flag=false;if(LCUNI=="ক"&&e=="হ")t="খ";else if(LCUNI=="গ"&&e=="হ")t="ঘ";else if(LCUNI=="চ"&&e=="হ"&&Avro_Cha_Flag==false){t="চ";Avro_Cha_Flag=true}else if(LCUNI=="চ"&&e=="হ"&&Avro_Cha_Flag==true){t="ছ";Avro_Cha_Flag=false}else if(LCUNI=="জ"&&e=="হ")t="ঝ";else if(LCUNI=="ট"&&e=="হ")t="ঠ";else if(LCUNI=="ড"&&e=="হ")t="ঢ";else if(LCUNI=="ত"&&e=="হ")t="থ";else if(LCUNI=="দ"&&e=="হ")t="ধ";else if(LCUNI=="প"&&e=="হ")t="ফ";else if(LCUNI=="ব"&&e=="হ")t="ভ";else if(LCUNI=="স"&&e=="হ")t="শ";else if(LCUNI=="শ"&&e=="হ")t="ষ";else if(LCUNI=="ড়"&&e=="হ")t="ঢ়";else if(LCUNI=="ণ"&&e=="গ")t="ঙ";else if(LCUNI=="ন"&&e=="গ")t="ং";else if(LCUNI=="ণ"&&e=="ঘ")t="ঞ";else if(LCUNI=="ঃ"&&e=="ঃ")t="ঃ";else if(LCUNI=="ট"&&e=="ট")t="ৎ";else if(LCUNI=="া"&&e=="ো")t="অ";else if(LCUNI=="ি"&&e=="ি")t="ী";else if(LCUNI=="ু"&&e=="ু")t="ূ";else if(LCUNI=="উ"&&e=="উ")t="ঊ";else if(LCUNI=="ও"&&e=="ই")t="ঐ";else if(LCUNI=="ো"&&e=="ি")t="ৈ";else if(LCUNI=="ও"&&e=="উ")t="ঔ";else if(LCUNI=="ো"&&e=="ু")t="ৌ";else if(LCUNI=="ৃ"&&e=="র")t="ৃ";else if(LCUNI=="ঋ"&&e=="ড়")t="ঋ";else if((LCUNI=="র"||LCUNI=="ড়")&&IsBanglaBanjonborno(e))t=e;else if(e=="ঁ")t=e;else if(IsBanglaBanjonborno(LCUNI)&&e=="অ"&&Avro_A_Press_Flag==false){Avro_A_Press_Flag=true;t=LCUNI}else if(IsBanglaBanjonborno(LCUNI)&&IsBanglaSoroborno(e)&&Avro_A_Press_Flag==true){t=e}else if(IsBanglaBanjonborno(LCUNI)&&IsBanglaSoroborno(e))t=MapSorbornoToKar(e);else if(IsBanglaBanjonborno(LCUNI)&&IsBanglaBanjonborno(e)&&Avro_A_Press_Flag==false)t="্"+e;else if(LCUNI=="অ"&&e=="অ")t="উ";else if(LCUNI=="অ"&&e=="ই")t="ঐ";else if(LCUNI=="অ"&&e=="ই")t="ঐ";else if(LCUNI=="া"&&e=="অ")t="ও";else if(LCUNI=="এ"&&e=="এ")t="ঈ";else if(LCUNI=="ে"&&e=="অ")t="ও";else if(LCUNI=="ও"&&e=="ঈ")t="ঔ";if(e!="অ"&&e!="্"&&Avro_A_Press_Flag==true)Avro_A_Press_Flag=false;return t}function ProcessCharacter(e,t,n,r){if(LCUNI=="‌"&&r=="্য"){RemoveNInsert(e,e.value.charAt(e.value.length-1)+"‌্য",1);ResetKarModifier();return}if(IsBanglaPostKar(r))ResetKarModifier();if(IsBanglaDigit(r))ResetKarModifier();if(LCUNI=="অ"&&r=="া"){RemoveNInsert(e,"আ",1);ResetKarModifier()}else if(IsBanglaHalant(LCUNI)&&IsBanglaKar(r)){RemoveNInsert(e,MapKarToSorborno(r),1);ResetKarModifier()}else if(KeyBoardLayout!=5&&IsBanglaNukta(LCUNI)&&IsBanglaPostKar(r)==true){RemoveNInsert(e,r+LCUNI,1);ResetKarModifier()}else if(KeyBoardLayout!=5&&IsBanglaNukta(LCUNI)&&IsBanglaFola(r)){RemoveNInsert(e,r+LCUNI,1);ResetKarModifier()}else if(KeyBoardLayout==2&&IsBanglaPreKar(LC_KAR))KarModification(e,r);else if(KeyBoardLayout==3&&IsSomewhereinPhoneticModifierCharaceter(r)&&IsSpace(LCUNI)==false){var i=GetSomewhereinPhoneticModifiedCharaceter(r);if(i!=r){r=i;RemoveNInsert(e,r,1);ResetKarModifier()}else Insert(e,r)}else if(KeyBoardLayout==4&&IsAvroPhoneticModifierCharaceter(r)&&IsSpace(LCUNI)==false){var i=GetAvroPhoneticModifiedCharaceter(r);if(i!=r){if(IsBanglaBanjonborno(LCUNI)&&r=="হ"){RemoveNInsert(e,i,1)}else if(IsBanglaBanjonborno(LCUNI)&&IsBanglaBanjonborno(r)){Insert(e,i)}else if(IsBanglaKar(LCUNI)&&IsBanglaSoroborno(r)){Insert(e,i)}else if(i==MapSorbornoToKar(r)){Insert(e,i)}else{RemoveNInsert(e,i,1)}r=i;ResetKarModifier()}else Insert(e,r)}else if(KeyBoardLayout!=5&&r=="র্")RefModification(e);else if(KeyBoardLayout!=5&&r=="া")OAndOuKarModification(e,"ো","া");else if(KeyBoardLayout!=5&&r=="ৗ")OAndOuKarModification(e,"ৌ","ৗ");else if(n>29){Insert(e,r)}else if(n==13&&IE){Insert(e,r)}if(IsBanglaHalant(LCUNI)==false&&IsBanglaPreKar(r))LC_KAR=r;if(!(IsBanglaNukta(LCUNI)&&IsBanglaFola(r))){LCUNI=r}}function KeyBoardDown(e){var t;if(IE)t=e.srcElement;else t=e.target;var n=window.event?event.keyCode:e.which;var r=String.fromCharCode(n);if(n==27)EnglishKeyboard=!EnglishKeyboard;if(n>=8&&n<=13||n==27||n==32||n==46){LCUNI=0;ResetKarModifier();Avro_Cha_Flag=false;Avro_A_Press_Flag=false}if(e.altKey&&e.ctrlKey&&(r=="E"||r=="e"))KeyBoardLayout=1;else if(e.altKey&&e.ctrlKey&&(r=="B"||r=="b"))KeyBoardLayout=KeyBoardLayout==2?1:2;else if(e.altKey&&e.ctrlKey&&(r=="P"||r=="p"))KeyBoardLayout=KeyBoardLayout==3?1:3;else if(e.altKey&&e.ctrlKey&&(r=="A"||r=="a"))KeyBoardLayout=KeyBoardLayout==4?1:4;else if(e.altKey&&e.ctrlKey&&(r=="U"||r=="u"))KeyBoardLayout=KeyBoardLayout==5?1:5;ChangeKeyboarLayoutStatus();if(n==27)return false;return true}function dg(e){var t;if(IE)t=e.srcElement;else t=e.target;var n=window.event?event.keyCode:e.which;var r=String.fromCharCode(n);if(e.altKey&&e.ctrlKey&&(r=="E"||r=="e"))return false;else if(e.altKey&&e.ctrlKey&&(r=="B"||r=="b"))return false;else if(e.altKey&&e.ctrlKey&&(r=="P"||r=="p"))return false;else if(e.altKey&&e.ctrlKey&&(r=="A"||r=="a"))return false;else if(e.altKey&&e.ctrlKey&&(r=="U"||r=="u"))return false;else if(e.ctrlKey||e.altKey)return true;if(KeyBoardLayout==1||EnglishKeyboard==true){return true}var i="";i=MapUnicodeCharacter(r);if(i==null)return true;ProcessCharacter(t,r,n,i);if(IE)event.keyCode=0;LC=r;if(n>29)return false;return true}var IE=document.all?1:0;var LCUNI=0;var LC=0;var LC_KAR=0;var LC_STRING="";var EnglishKeyboard=false;var KeyBoardLayout=2;var ctl_v_conversion=false;var Avro_Cha_Flag=false;var Avro_A_Press_Flag=false;var bijoy_keyboard_map={0:"০",1:"১",2:"২",3:"৩",4:"৪",5:"৫",6:"৬",7:"৭",8:"৮",9:"৯",a:"ৃ",A:"র্",d:"ি",D:"ী",s:"ু",S:"ূ",f:"া",F:"অ",g:"্",G:"।",h:"ব",H:"ভ",j:"ক",J:"খ",k:"ত",K:"থ",l:"দ",L:"ধ",z:"্র",Z:"্য",x:"ও",X:"ৗ",c:"ে",C:"ৈ",v:"র",V:"ল",b:"ন",B:"ণ",n:"স",N:"ষ",m:"ম",M:"শ",q:"ঙ",Q:"ং",w:"য",W:"য়",e:"ড",E:"ঢ",r:"প",R:"ফ",t:"ট",T:"ঠ",y:"চ",Y:"ছ",u:"জ",U:"ঝ",i:"হ",I:"ঞ",o:"গ",O:"ঘ",p:"ড়",P:"ঢ়","&":"ঁ",$:"৳","`":"‌","~":"‍","\\":"ৎ","|":"ঃ"};var somewherein_phonetic_keyboard_map={0:"০",1:"১",2:"২",3:"৩",4:"৪",5:"৫",6:"৬",7:"৭",8:"৮",9:"৯",a:"া",A:"আ",d:"ড",D:"দ",s:"স",S:"ষ",f:"ফ",F:"ঋ",g:"গ",G:"ঘ",h:"হ",H:"ঃ",j:"জ",J:"ঝ",k:"ক",K:"খ",l:"ল",L:"খ",z:"য",Z:"ত",x:"ক্স",X:"ঢ",c:"চ",C:"ছ",v:"ভ",V:"ঠ",b:"ব",B:"ই",n:"ন",N:"ণ",m:"ম",M:"গ",q:"য়",Q:"ছ",w:"ৃ",W:"ঋ",e:"ে",E:"এ",r:"র",R:"ড়",t:"ট",T:"ত",y:"য়",Y:"্য",u:"ু",U:"উ",i:"ি",I:"ই",o:"ো",O:"ও",p:"প",P:"চ","&":"্",$:"৳","+":"্",".":"।","`":"‌","~":"‍","\\":"॥","|":"।"};var avro_phonetic_keyboard_map={0:"০",1:"১",2:"২",3:"৩",4:"৪",5:"৫",6:"৬",7:"৭",8:"৮",9:"৯",o:"অ",a:"আ",A:"আ",i:"ই",I:"ঈ",u:"উ",U:"ঊ",e:"এ",E:"এ",O:"ও",d:"দ",D:"ড",s:"স",S:"শ",f:"ফ",g:"গ",h:"হ",H:"হ",j:"জ",J:"য",k:"ক",K:"ক",l:"ল",L:"ল",z:"য",Z:"্য",c:"চ",v:"ভ",V:"ভ",b:"ব",n:"ন",N:"ণ",m:"ম",y:"য়",w:"্ব",r:"র",R:"ড়",t:"ত",T:"ট",y:"য়",p:"প",$:"৳","+":"্",".":"।",":":"ঃ","^":"ঁ","`":"্"};var unijoy_keyboard_map={0:"০",1:"১",2:"২",3:"৩",4:"৪",5:"৫",6:"৬",7:"৭",8:"৮",9:"৯",a:"ৃ",A:"র্",d:"ি",D:"ী",s:"ু",S:"ূ",f:"া",F:"অ",g:"্",G:"।",h:"ব",H:"ভ",j:"ক",J:"খ",k:"ত",K:"থ",l:"দ",L:"ধ",z:"্র",Z:"্য",x:"ো",X:"ৌ",c:"ে",C:"ৈ",v:"র",V:"ল",b:"ন",B:"ণ",n:"স",N:"ষ",m:"ম",M:"শ",q:"ঙ",Q:"ং",w:"য",W:"য়",e:"ড",E:"ঢ",r:"প",R:"ফ",t:"ট",T:"ঠ",y:"চ",Y:"ছ",u:"জ",U:"ঝ",i:"হ",I:"ঞ",o:"গ",O:"ঘ",p:"ড়",P:"ঢ়","&":"ঁ",$:"৳","`":"‌","~":"‍","^":"÷","*":"×","\\":"ৎ","|":"ঃ"}